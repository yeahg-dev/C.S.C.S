# 프로세스

프로세스란 실행중인 프로그램이다.

## 프로세스의 문맥

→ 씨피유 수행 상태를 나타내는 하드웨어 문맥(상태를 나타내는 데에 필요한 정보)

- 프로그램 카운터: 어떤 인스트럭션을 가리키는지
- 각종 레지스터: 어떤 값을 가지고 있는지
- 프로세스의 주소 공간: code, data, stack
- 프로세스 관련 커널 자료 구조: PCB, Kernel stack

## 프로세스의 상태

### Running

- cpu를 잡고 인스트럭션을 수행중인 상태

### Ready

- cpu를 기다리는 상태(메모리 등 다른조건은 만족을 하고)

### Blocked

- cpu를 줘도 당장 인스트럭션을 수행할 수 없는 상태
- 프로세스가 요청한 이벤트가 즉시 만족되지 않아 이를 기다리는 상태(예: 디스크에서 file을 읽어와야하는 경우)

### new

- 프로세스가 생성중인 상태

### terminated

- 프로세스가 종료중인 상태

## PCB

Process Control Block

- OS가 관리하는데에 사용하는 정보
    - 프로세스 상태, 프로세스 ID
    - 스케줄링 정보
- cpu 관련 하드웨어 값
    - 프로그램 카운터, 레지스터
- 메모리 정보
- 파일 정보

## 문맥교환

- cpu를 현재 프로제스에서 다른 프로세스로 넘겨주는 것
- 현재 프로세스의 상태를 PCB에 저장하고, 넘겨받는 프로세스의 상태를 PCB에서 읽어온다.
- 시스템콜이나 인터럽트 발생 시 문맥교환이 반드시 일어나는 것은 아니다.

## 스케줄링 큐의 종류

### 잡 큐

현재 시스템의 모든 프로세스의 집합

### 레디 큐

cpu를 할당받고 실행되기를 기다리는 프로세스의 집합

### 디바이스 큐

I/O 처리를 기다리는 프로세스의 집합

## 스케줄러

### 장기 스케줄러

- 잡스케줄러
- 시작 프로세스 중 어떤 걸 레디큐로 보낼지 결정
- 프로세스에 메모리를 주는 문제
- 메모리에 몇개의 프로그램이 동시에 올라가있는지 제어(멀티프로그래밍)
- 타임쉐어링 시스템에는 보통 장기스케줄러가 없음(무조건 레디)

### 단기 스케줄러

- cpu 스케줄러
- 다음번에 어떤 프로세스를 실행할지 결정
- 프로세스에 cpu를 주는 문제
- 충분히 빨라야함

### 중기 스케줄러

- 스와퍼
- 여유공간 마련을 위해 프로세스를 통째로 메모리에서 디스크로 쫓아냄
- 프로세스에게서 메모리를 뻇는 문제
- 메모리에 올라와있는 프로그램 개수를 조절

→ 중기 스케줄러로 인해 하나의 상태가 추가된다.

- Suspended(Stoped) 추가
    - 외부적인 이유로 프로세스 수행이 정지된 상태
    - 통째로 디스크에 swap out된다
    

## 스레드

프로세스 내부에 cpu실행 단위가 여러개 있는 경우 그것을 스레드라고 부른다

프로세스의 메모리와 PCB를 공유한다.

### 스레드의 구성

- 프로그램 카운터
- 레지스터 셋
- 스택 공간

### 동료 스레드와 공유하는 부분(=task)

- 코드 섹션
- 데이터 섹션
- OS 자원

- 다중 스레드로 구성된 테스크 구조에서는 하나의 서버 스레드가 Blocked(waiting) 상태인 동안에도 동일 테스크 내의 다른 스레드가 러닝되어 빠른 처리를 할 수 있다
- 스레드를 사용하면 병렬성을 높일 수 있다
